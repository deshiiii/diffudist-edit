<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computing diffusion distances between network's nodes • diffudist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computing diffusion distances between network's nodes">
<meta property="og:description" content="diffudist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diffudist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/diffusion-distances.html">Computing diffusion distances between network's nodes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gbertagnolli/diffudist/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="diffusion-distances_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computing diffusion distances between network’s nodes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gbertagnolli/diffudist/blob/master/vignettes/diffusion-distances.Rmd"><code>vignettes/diffusion-distances.Rmd</code></a></small>
      <div class="hidden name"><code>diffusion-distances.Rmd</code></div>

    </div>

    
    
<div id="diffu-dist" class="section level1" short-title="diffusion distance">
<h1 class="hasAnchor">
<a href="#diffu-dist" class="anchor"></a>The diffusion distance</h1>
<p>Let <span class="math inline">\(G=(V,E)\)</span> be a single-layer unweighted and undirected network. Let <span class="math inline">\(\mathbf{A}\)</span> be its adjacency matrix, i.e. <span class="math inline">\(|V| = N\)</span>, the nodes in <span class="math inline">\(V\)</span> are labelled as <span class="math inline">\(i \in 1, \dots, N\)</span> and <span class="math inline">\(\mathbf{A}\)</span> is an <span class="math inline">\(N \times N\)</span> symmetric matrix such that <span class="math inline">\(A_{ij} = A_{ji}= 1\)</span> if and only if <span class="math inline">\(\{i, j\} \in E\)</span> and <span class="math inline">\(A_{ij} = A_{ji}= 0\)</span> otherwise. The degree of vertex <span class="math inline">\(i\)</span> is the number of its adjacent nodes, i.e. <span class="math inline">\(k_i = \sum_{j = 1}^{N} A_{ij} = \left(\mathbf{A} \mathbf{1}\right)_i\)</span>, and we collect the degrees of all vertices into the diagonal matrix <span class="math inline">\(\mathbf{D}\)</span>. Let us also assume that there are no isolated nodes, i.e. <span class="math inline">\(k_i &gt; 0\)</span> for all <span class="math inline">\(i \in 1, \dots, N\)</span> or, if there are isolated nodes, we use the convention <span class="math inline">\((k_i)^{-1} = 0\)</span> if <span class="math inline">\(k_i = 0\)</span>.</p>
<p>The matrix <span class="math inline">\(\mathbf{T} = \mathbf{D}^{-1} \mathbf{A}\)</span> can be seen as the transition matrix of a random walk on the network <span class="math inline">\(G\)</span>, a discrete-time Markov chain on the set of vertices <span class="math inline">\(V\)</span>, with transition probabilities given by the connectivity of <span class="math inline">\(G\)</span>. <span class="math inline">\(T_{ij} = \frac{A_{ij}}{k_i}\)</span> is the probability of going from node <span class="math inline">\(i\)</span> to node <span class="math inline">\(j\)</span> and it is different from 0 only if there is an edge connecting <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. Furthermore, from <span class="math inline">\(i\)</span> the random walker has equal probability of transitioning to each of its neighbours (adjacent nodes). Observe that <span class="math inline">\(\mathbf{T}^k\)</span> is the k-step transition probability matrix, which is however not immediate to compute, since <span class="math inline">\(\mathbf{T}\)</span> is, in general, not symmetric and <span class="math inline">\(N\)</span> can be very large.</p>
<p>From this discrete-time random walk we can also define its  versiona continuous-time Markov chain with exponential holding times with rate <span class="math inline">\(\lambda = 1\)</span> and jumping probabilities given by <span class="math inline">\(\mathbf{T}\)</span> <span class="citation">(Norris 1998; Masuda, Porter, and Lambiotte 2017)</span>. In particular the continuous-time process is generated by the <span class="math inline">\(Q-\)</span>matrix <span class="math inline">\(-(\mathbf{I}- \mathbf{T})\)</span>, where <span class="math inline">\(\mathbf{I}- \mathbf{T} = \mathbf{\tilde{L}}\)</span> corresponds to the (random walk) normalised Laplacian <span class="citation">(F. R. K. Chung 1997)</span> of <span class="math inline">\(G\)</span>, and the dynamics is controlled by the forward (or master) equation <span class="math display">\[\begin{equation}
  \frac{d}{d\tau}\mathbf{p}(\tau) = - \mathbf{p}(\tau) \mathbf{\tilde{L}}.
\end{equation}\]</span></p>
<p>Given the initial condition <span class="math inline">\(\mathbf{p(\tau = 0)} = \mathbf{e}_i\)</span>, the canonical vector with components <span class="math inline">\(e_j = 0\)</span> for all <span class="math inline">\(j\neq i\)</span> and <span class="math inline">\(e_{i} = 1\)</span>, which corresponds to the deterministic initial condition with the random walker starting in node <span class="math inline">\(i\)</span>, the solution of the master equation at time <span class="math inline">\(\tau &gt; 0\)</span> is <span class="math display">\[\begin{equation}
  p_{ij} = \left(e^{-\tau \tilde{\mathbf{L}}}\right)_{ij}
\end{equation}\]</span> and can be equivalently seen as: * the transition probability from node <span class="math inline">\(i\)</span> to node <span class="math inline">\(j\)</span> in the time interval <span class="math inline">\([0, \tau]\)</span>, or * the probability of fining the random walker (i.e. the process) in node (state) <span class="math inline">\(j\)</span> at time <span class="math inline">\(\tau\)</span> given that it started in node <span class="math inline">\(i\)</span> at time 0.</p>
<p>Let us call <span class="math inline">\(\mathbf{P}(\tau) = e^{-\tau \tilde{\mathbf{L}}}\)</span>. <span class="math inline">\(\mathbf{P}(\tau)\)</span> is a stochastic matrix and is given by <span class="math display">\[\begin{equation}
  e^{-\tau \tilde{\mathbf{L}}} = \sum_{h = 0}^{+\infty} \frac{(-\tau \tilde{\mathbf{L}})^h}{h!}.
\end{equation}\]</span> Again here we have powers of a non-symmetric matrix. However, the normalised Laplacian can be written as <span class="math inline">\(\tilde{\mathbf{L}} = D^{-\frac12}\mathcal{L}^{\text{sym}}D^{\frac12}\)</span>, with <span class="math inline">\(\mathcal{L}^{\text{sym}} = D^{-\frac12} (D - A) D^{-\frac12}\)</span> being the symmetric normalised Laplacian, which has a spectrum of real, non-negative eigenvalues, and whose eigenvectors can be chosen to form an orthogonal matrix <span class="math inline">\(\mathbf{U}\)</span> <span class="citation">(F. R. K. Chung 1997)</span>, so that <span class="math inline">\(\mathcal{L}^{\text{sym}} = \mathbf{U} \boldsymbol{\Lambda} \mathbf{U}^T\)</span>. It follows that <span class="math inline">\(\tilde{\mathbf{L}} = D^{-\frac12} \left( \mathbf{U} \boldsymbol{\Lambda} \mathbf{U}^T \right) D^{\frac12}\)</span> and the evaluation of <span class="math inline">\(e^{-t \tilde{\mathbf{L}}}\)</span> reduces to a diagonalisation of the symmetric normalised Laplacian and to the exponentiation of its spectrum, i.e. <span class="math inline">\(e^{-t \tilde{\mathbf{L}}} = \left(D^{-\frac12} \mathbf{U} \right) e^{-t\boldsymbol{\Lambda}} \left(\mathbf{U}^T D^{\frac12}\right)\)</span>.</p>
<p>Let us denote by <span class="math inline">\(\mathbf{p}(\tau|i) = \left(e^{-t \tilde{\mathbf{L}}}\right)_{i\cdot}\)</span> the probability vector corresponding to the <span class="math inline">\(i-\)</span>th row of the exponential matrix <span class="math inline">\(e^{-t \tilde{\mathbf{L}}} = \mathbf{P}(t)\)</span>, which gives the posterior probability distribution of finding the random walker across the network at time <span class="math inline">\(t\)</span> given that the walk started in node <span class="math inline">\(i\)</span> with probability 1. The Euclidean distance between two rows of matrix <span class="math inline">\(\mathbf{P}(t)\)</span> and hence, the distance between two posterior probability distributions corresponding to different starting nodes, induced a distance between the nodes of the network, called the  <span class="citation">(De Domenico 2017)</span>:</p>
<p><span class="math display">\[\begin{equation}
  D_{\tau}(i, j) = \lVert \mathbf{p}(\tau|i) - \mathbf{p}(\tau|j) \rVert_2.
\end{equation}\]</span></p>
<p>To be precise this construction yields a family of diffusion distances <span class="math inline">\(\left(D_{\tau}(i, j)\right)_{t&gt;0}\)</span>, because of the dependence of <span class="math inline">\(D_{\tau}\)</span> on time <span class="math inline">\(t\)</span>. As shown in <span class="citation">(Coifman and Lafon 2006; Lambiotte, Delvenne, and Barahona 2014; De Domenico 2017)</span> <span class="math inline">\(t\)</span> serves as a resolution parameter. Intuitively, for increasing time <span class="math inline">\(t\)</span> the Markov chain (or the random walker) can explore larger parts of the network and this is particularly evident if we look at the discrete-time jump chain <span class="math inline">\(\mathbf{p}(n + 1) = \mathbf{p}(n) \mathbf{T} = \mathbf{p}(0) \mathbf{T}^n = \mathbf{p}(0) \left(\mathbf{D}^{-1}\mathbf{A}\right)^n\)</span>. It is known that the <span class="math inline">\(ij-\)</span>th entry of the <span class="math inline">\(n-\)</span>th power of the adjacency matrix, <span class="math inline">\(\left(\mathbf{A}^n\right)_{ij}\)</span>, counts the walks of length <span class="math inline">\(n\)</span> starting in <span class="math inline">\(i\)</span> and ending in <span class="math inline">\(j\)</span>. <!-- It can be also seen from the eq.\@ref(eq:exp-matrix) [observations on exponential matrix...] --> Integrating <span class="math inline">\(D_{\tau}\)</span> over time, to get rid of the dependence on <span class="math inline">\(\tau\)</span>, yields the persistent functional patterns in networks. <!-- If the network is connected and non bipartite [@Chung1997] then the limiting distribution for $t\to \infty$ exists and coincides with the invariant distribution... --></p>
<p>The extensions of this distance to weighted, directed or even more complicated networks, such as multilayers is easily integrated as soon as we can define the transition rules from node to node. For weighted directed networks we just need to replace the dyadic adjacency matrix with its weighted counterpart <span class="math inline">\(\mathbf{W}\)</span> and a node’s degree with its out-going strength. In <span class="citation">(Bertagnolli and De Domenico 2021)</span> for instance, the diffusion distance has been generalised not only to multiplex and interconnected systems, but also to different types of random walk dynamicse.g. maximal-entropy or PageRank random walkstaking place on the same networked system.</p>
<p>The diffusion distances are bounded in <span class="math inline">\([0, \sqrt{2}]\)</span> since <span class="math inline">\(\lVert \mathbf{p}(\tau|i) \rVert_2 \leq \lVert \mathbf{p}(\tau|i) \rVert_1 = 1\)</span> for all nodes <span class="math inline">\(i \in V\)</span>. Furthermore the average squared diffusion distance (ASDD) <span class="math display">\[\begin{equation}
\mathcal{D}^2_{\tau} = \frac{1}{2 N^2} \sum_{i, j = 1}^N D^2_{\tau}(i, j)
\end{equation}\]</span> is equal to the sum of the (biased) sample variances of the random vector <span class="math inline">\(\mathbf{p}(\tau|i)\)</span>, <span class="math inline">\(\sum\limits_{i=1}^N \sum\limits_{l=1}^N \left(p_{il} - \bar{p}_i\right)^2\)</span> and, thus, it is a measure of the dispersion of the network. The proof follows from the known equivalence <span class="math display">\[
s_{X}^{2} = \text{cov}(X, X) = \frac{1}{2 N^2} \sum_{i=1}^{N} \sum_{j=1}^{N} \left(x_{i}-x_{j}\right)^{2}
\]</span> for a sample from a random variable <span class="math inline">\(X\)</span>.</p>
</div>
<div id="using-the-diffudist-package" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-diffudist-package" class="anchor"></a>Using the diffudist package</h1>
<p>The main function in the <code>diffudist</code> is <code><a href="../reference/get_distance_matrix.html">get_distance_matrix()</a></code>, or its shorter alias <code><a href="../reference/get_distance_matrix.html">get_DDM()</a></code>, which returns the distances <span class="math inline">\(D_{\tau}(i, j)\)</span> for all nodes <span class="math inline">\(i,j\)</span> in the network at some time <span class="math inline">\(\tau\geq 0\)</span>, as presented in the previous section. Its arguments are</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_distance_matrix.html">get_distance_matrix</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">tau</span>, type <span class="op">=</span> <span class="st">"Normalized Laplacian"</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, 
                    as_dist <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>where <code>g</code> is the network (in the <code>igraph</code> format), whose nodes you want to compute distances for; <code>tau</code> is the parameter <span class="math inline">\(\tau\)</span> in the master equation controlling the diffusion time. <code>type</code> refers to the type of dynamics used for the mapping from nodes to points in the diffusion space. By default it is set to “Normalized Laplacian,” <span class="math inline">\(\mathbf{\tilde{L}} = \mathbf{I} - \mathbf{D}^{-1} \mathbf{A}\)</span>, the generator of the classical (node-centric) continuous-time random walk as described in Section . Other types of random walk dynamics generators are available and will be described at the end of this section. The <code>weights</code> parameter allows to switch from a weighted to an unweighted network. Mind that, similarly to the <code>igraph</code> package <span class="citation">(Csardi and Nepusz 2006)</span>, if <code>weights = NULL</code> and the network <code>g</code> has and edge attribute called “weight,” then this is used automatically. Finally, <code>as_dist</code> gives the possibility to control the class of the returned object (either a matrix or a “dist” object) and only if <code>verbose</code> is set to <code>TRUE</code> messages about the progress and warnings are shown.</p>
<div id="the-classical-random-walk-and-its-induced-diffusion-distances" class="section level2">
<h2 class="hasAnchor">
<a href="#the-classical-random-walk-and-its-induced-diffusion-distances" class="anchor"></a>The classical random walk and its induced diffusion distances</h2>
<p>To illustrate the usage of the package <code>diffudist</code> let us start with a small well-known network: Zachary’s karate club network <span class="citation">(Zachary 1977)</span>. After loading the packages <code>igraph</code>, for manipulating networks, and our <code>diffudist</code>, we download the weighted adjacency matrix of the karate club network<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and build the network <code>karate</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gbertagnolli.github.io/diffudist/">diffudist</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/igraph_options.html">igraph_options</a></span><span class="op">(</span>vertex.frame.color <span class="op">=</span> <span class="st">"white"</span>, vertex.color <span class="op">=</span> <span class="st">"#00B4A6"</span><span class="op">)</span>
<span class="co"># dataset</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"http://vlado.fmf.uni-lj.si/pub/networks/data/ucinet/zachary.dat"</span><span class="op">)</span>, 
                 skip <span class="op">=</span> <span class="fl">41</span>, sep <span class="op">=</span> <span class="st">" "</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Actor"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">33</span><span class="op">)</span>, <span class="st">"John A"</span><span class="op">)</span>
<span class="va">karate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">A</span>, mode <span class="op">=</span> <span class="st">"undirected"</span>, weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">33</span>, <span class="st">"A"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">Faction</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">Faction</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">21</span>, <span class="fl">23</span><span class="op">:</span><span class="fl">34</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">3</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">Faction</span><span class="op">]</span></code></pre></div>
<p>Plot the network:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, edge.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="diffusion-distances_files/figure-html/karate-plot-1.png" alt="**Figure 1** Zachary's karate club network. The node colour represents the 'faction' the corresponding Actor belongs to after the club splits. Nodes labelled as 'A' and 'H' correspond respectively to John A., the club administrator, and Mr. Hi, the instructor." width="768"><p class="caption">
<strong>Figure 1</strong> Zachary’s karate club network. The node colour represents the ‘faction’ the corresponding Actor belongs to after the club splits. Nodes labelled as ‘A’ and ‘H’ correspond respectively to John A., the club administrator, and Mr. Hi, the instructor.
</p>
</div>
<p>The <code>karate</code> network has <span class="math inline">\(N=34\)</span> nodes and 78 edges, different vertex attributes and the <code>weight</code> attribute of its edges. The nodes in Zachary’s karate club network are members of a university karate club, called Actors in the social networks jargon (see <code><a href="https://rdrr.io/r/utils/head.html">head(V(karate)$name)</a></code>) and the weighted links connecting them encode interactions outside the club during three years, which were documented by Zachary. The network is well-known especially as a community detection benchmark, seeing as how Zachary was able (and lucky) to witness and document a conflict that arose during the study and eventually led to the splitting of the club in two “Factions” centred around the instructor (Mr. Hi) and the club administrator (John A.).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">karate_unw_ddm_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">tau</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/get_distance_matrix.html">get_distance_matrix</a></span><span class="op">(</span><span class="va">karate</span>, tau <span class="op">=</span> <span class="va">tau</span>, weights <span class="op">=</span> <span class="cn">NA</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">karate_unw_ddm_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">ddm</span> <span class="op">&lt;-</span> <span class="va">karate_unw_ddm_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
  <span class="fu"><a href="../reference/plot_distance_matrix.html">plot_distance_matrix</a></span><span class="op">(</span><span class="va">ddm</span>, cex <span class="op">=</span> <span class="fl">1.3</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">tau</span><span class="op">==</span><span class="fu">.</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">karate_unw_ddm_plots</span>, <span class="va">show</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diffusion-distances_files/figure-html/unw-ddms-plots-1.png" alt="**Figure 2** Diffusion distances of the unweighted karate club network at different diffusion times and w.r.t. the classical random walk (CRW)." width="47%"><img src="diffusion-distances_files/figure-html/unw-ddms-plots-2.png" alt="**Figure 2** Diffusion distances of the unweighted karate club network at different diffusion times and w.r.t. the classical random walk (CRW)." width="47%"><img src="diffusion-distances_files/figure-html/unw-ddms-plots-3.png" alt="**Figure 2** Diffusion distances of the unweighted karate club network at different diffusion times and w.r.t. the classical random walk (CRW)." width="47%"><img src="diffusion-distances_files/figure-html/unw-ddms-plots-4.png" alt="**Figure 2** Diffusion distances of the unweighted karate club network at different diffusion times and w.r.t. the classical random walk (CRW)." width="47%"><p class="caption">
<strong>Figure 2</strong> Diffusion distances of the unweighted karate club network at different diffusion times and w.r.t. the classical random walk (CRW).
</p>
</div>
<p>As one can see in Fig.2, at small time scales <span class="math inline">\(\tau = 1, 2\)</span>, plots a) and b), there are two main blocks, while already at <span class="math inline">\(\tau = 4\)</span> a small cluster, consisting of Actors 5, 6, 7, 11 and 17, emerges These nodes form almost a clique and are connected only to Mr. Hi and no other node in the network. They hence form a distinct functional cluster at larger resolutions. This “issue” is well-known among network scientists and, indeed, several algorithms for community detection actually find four clusters instead of two <span class="citation">(Fortunato 2010)</span>, although the two module partition is more stable <span class="citation">(Arenas, Fernández, and Gómez 2008)</span>. Another common misclassification <span class="citation">(Fortunato 2010)</span> involves Actors 3, 9 and 10. The first follows Mr. Hi after the fission, while the other two follow John A. At <span class="math inline">\(\tau = 1\)</span> all three nodes fall in the same clustered with John A., while at <span class="math inline">\(\tau = 2\)</span> Actor 3 becomes closer to Mr. Hi in agreement with the real post-conflict configuration.</p>
<p>This misclassification does not happen when edge weights, the strength of the ties between the club members, are taken into account, as you can see in Fig.3.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">karate_w_ddm_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">tau</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/get_distance_matrix.html">get_distance_matrix</a></span><span class="op">(</span><span class="va">karate</span>, tau <span class="op">=</span> <span class="va">tau</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_clu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">karate_w_ddm_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">memb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">res_clu</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">res_clu</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, vertex.shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"circle"</span>, <span class="st">"square"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="diffusion-distances_files/figure-html/karate-plot-hclust-1.png" alt="**Figure 3** Community detection of the weighted karate club network through hierarchical clustering of diffusion distances at $\tau = 1$. As in Fig.1 the colour of nodes depends on their faction, while their shape corresponds to the cluster assigned by the hierarchical clustering `hclust` on the diffusion distances $D_{\tau = 1}$." width="768"><p class="caption">
<strong>Figure 3</strong> Community detection of the weighted karate club network through hierarchical clustering of diffusion distances at <span class="math inline">\(\tau = 1\)</span>. As in Fig.1 the colour of nodes depends on their faction, while their shape corresponds to the cluster assigned by the hierarchical clustering <code>hclust</code> on the diffusion distances <span class="math inline">\(D_{\tau = 1}\)</span>.
</p>
</div>
<p>Also, if we look at the distance matrices in Fig.4 we find a persistent organisation of nodes in two main modules. Finally note that, overall, the pairwise distances become smaller as <span class="math inline">\(\tau\)</span> increases<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, nevertheless the intra-community distances shrink faster than the inter-communities distances, as found in <span class="citation">(De Domenico 2017)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">karate_w_ddm_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">ddm</span> <span class="op">&lt;-</span> <span class="va">karate_w_ddm_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
  <span class="fu"><a href="../reference/plot_distance_matrix.html">plot_distance_matrix</a></span><span class="op">(</span><span class="va">ddm</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">tau</span><span class="op">==</span><span class="fu">.</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">karate_w_ddm_plots</span>, <span class="va">show</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diffusion-distances_files/figure-html/w-ddms-plots-1.png" alt="**Figure 4** Diffusion distances of the weighted karate club network. As in Fig.2, but accounting also for interactions strenghts (i.e. edge weights). Observe that in this case there are no misclassifications and the (main) two-module partition is stable over time." width="47%"><img src="diffusion-distances_files/figure-html/w-ddms-plots-2.png" alt="**Figure 4** Diffusion distances of the weighted karate club network. As in Fig.2, but accounting also for interactions strenghts (i.e. edge weights). Observe that in this case there are no misclassifications and the (main) two-module partition is stable over time." width="47%"><img src="diffusion-distances_files/figure-html/w-ddms-plots-3.png" alt="**Figure 4** Diffusion distances of the weighted karate club network. As in Fig.2, but accounting also for interactions strenghts (i.e. edge weights). Observe that in this case there are no misclassifications and the (main) two-module partition is stable over time." width="47%"><img src="diffusion-distances_files/figure-html/w-ddms-plots-4.png" alt="**Figure 4** Diffusion distances of the weighted karate club network. As in Fig.2, but accounting also for interactions strenghts (i.e. edge weights). Observe that in this case there are no misclassifications and the (main) two-module partition is stable over time." width="47%"><p class="caption">
<strong>Figure 4</strong> Diffusion distances of the weighted karate club network. As in Fig.2, but accounting also for interactions strenghts (i.e. edge weights). Observe that in this case there are no misclassifications and the (main) two-module partition is stable over time.
</p>
</div>
<p>In order to compare diffusion distances at different times or between different networks, one can normalise the distance matrix <span class="math inline">\(\mathbf{D}_{\tau}\)</span> over the maximum, i.e. <span class="math inline">\(\mathbf{\hat{D}}_{\tau} = \frac{\mathbf{D}_{\tau}}{\max{\mathbf{D}_{\tau}}}\)</span>, as shown in Fig. 5 for the average distance matricesobtained calling the function <code><a href="../reference/get_mean_distance_matrix.html">get_mean_distance_matrix()</a></code> on the list of diffusion distance matrices at different values of <span class="math inline">\(\tau\)</span>of the unweighted and weighted karate club network. As mentioned in Section , averaging diffusion distances over time yields the persistent diffusion geometry of the network, which is very similar for both its versions (weighted and not).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">karate_unw_ddm_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mean_distance_matrix.html">get_mean_distance_matrix</a></span><span class="op">(</span><span class="va">karate_unw_ddm_list</span><span class="op">)</span>
<span class="va">karate_w_ddm_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mean_distance_matrix.html">get_mean_distance_matrix</a></span><span class="op">(</span><span class="va">karate_w_ddm_list</span><span class="op">)</span>
<span class="co"># then divide by max() and plot as before (but with  show_dendro = FALSE)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diffusion-distances_files/figure-html/avg-ddms-plot-1.png" alt="**Figure 5** Comparison of the normalised average diffusion distance matrices for the unweighted/weighted karate club network." width="47%"><img src="diffusion-distances_files/figure-html/avg-ddms-plot-2.png" alt="**Figure 5** Comparison of the normalised average diffusion distance matrices for the unweighted/weighted karate club network." width="47%"><p class="caption">
<strong>Figure 5</strong> Comparison of the normalised average diffusion distance matrices for the unweighted/weighted karate club network.
</p>
</div>
</div>
<div id="rw-types" class="section level2" short-title="rw types">
<h2 class="hasAnchor">
<a href="#rw-types" class="anchor"></a>Other random walk dynamics</h2>
<p>Until now, we have studied the functional shape of a network revealed by the diffusion distance based on the classical random walk (CRW), which is characterised by the transition matrix <span class="math inline">\(\mathbf{T} = \mathbf{D}^{-1} \mathbf{A}\)</span> and its corresponding normalised Laplacian. There are, although, other possibilities; a few other types of random walk dynamics are already implemented in the <code>diffudist</code> and, in particular:</p>
<ul>
<li>the unnormalised Laplacian <span class="math inline">\(\mathbf{L} = \mathbf{D} - \mathbf{A}\)</span>, generating an edge-centric continuous-time random walk <span class="citation">(Masuda, Porter, and Lambiotte 2017)</span>;</li>
<li>the quantum laplacian, which is equivalent to the symmetric normalised Laplacian <span class="math inline">\(\mathcal{L}^{\text{sym}}\)</span> and generates a valid quantum (random) walk <span class="math inline">\(P(t) = e^{-i \mathcal{L}^{\text{sym}} t}\)</span> with <span class="math inline">\(i\)</span> being the imaginary unit <span class="citation">(Biamonte, Faccin, and De Domenico 2019)</span>;</li>
<li>the maximal-entropy random walk (MERW) Laplacian <span class="math inline">\(\mathbf{I} - \mathbf{T}^{\text{MERW}}\)</span>, where <span class="math inline">\(T_{ij}^{\text{MERW}} = \frac{A_{ij}}{\lambda}\frac{\psi_i}{\psi_j}\)</span> with <span class="math inline">\(\lambda\)</span> being the eigenvalue of the adjacency matrix and <span class="math inline">\(\boldsymbol{\psi} \mathbf{A} = \lambda \boldsymbol{\psi}\)</span> is the corresponding normalised eigenvector <span class="citation">(Burda et al. 2009)</span>.</li>
</ul>
<p>Additionally, one can also provide a generic (valid) transition matrix <span class="math inline">\(T\)</span> (also called <span class="math inline">\(\Pi\)</span> in the literature and called <code>Pi</code> in the code) and use <code><a href="../reference/get_distance_matrix_from_T.html">get_distance_matrix_from_T(Pi, tau, verbose = TRUE)</a></code> to obtain the mutual diffusion distances w.r.t. the custom random walk dynamic. Let’s look, for instance at the PageRank random walk (PRRW) Laplacian <span class="math inline">\(\mathbf{I} - \mathbf{T}^{\text{PRRW}}\)</span> <span class="citation">(Brin and Page 1998; F. Chung and Zhao 2010)</span>: this random walk is characterized by a teleportation parameter <span class="math inline">\(\alpha \in [0, 1)\)</span> which, at each step, enables the random walker to jump to any node (chosen uniformly at random) in the network. In particular the walker can reach (i) with probability <span class="math inline">\(1 - \alpha\)</span> any node in the network and (ii) with probability <span class="math inline">\(\alpha\)</span> one of its adjacent nodes. The master equation for the discrete-time PRRW reads <span class="math display">\[
p_{i}(n+1) = \alpha \sum_{j=1}^{N} p_{j}(n) T^{\text{CRW}}_{j i} + (1-\alpha) u_{i}
\]</span> where <span class="math inline">\(u_{i}\)</span> is a vector satisfying <span class="math inline">\(\sum_{i=1}^N u_{i} = 1\)</span>, usually a uniform probability vector <span class="math inline">\(\frac1N \mathbf{1}\)</span>, where is a (row) vector of all ones. The transition matrix is then given by <span class="math display">\[
\mathbf{T}^{\text{PRRW}} = \alpha \mathbf{D}^{-1} \mathbf{A} + (1 - \alpha) \frac1N \mathbf{1}^T \mathbf{1}
\]</span></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">.85</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">gorder</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span>
<span class="va">D_inv_karate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/strength.html">strength</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">)</span>
<span class="va">W_karate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as_adjacency_matrix.html">as_adjacency_matrix</a></span><span class="op">(</span><span class="va">karate</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span>, attr <span class="op">=</span> <span class="st">"weight"</span><span class="op">)</span>
<span class="va">T_prrw</span> <span class="op">&lt;-</span> <span class="va">alpha</span> <span class="op">*</span> <span class="va">D_inv_karate</span> <span class="op">%*%</span> <span class="va">W_karate</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">/</span> <span class="va">N</span> 
<span class="co"># its corresponding Laplacian would be:</span>
<span class="co"># L_prrw &lt;- diag(rep(1, N)) - T_prrw</span>
<span class="va">ddm_prrw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_distance_matrix_from_T.html">get_distance_matrix_from_T</a></span><span class="op">(</span>Pi <span class="op">=</span> <span class="va">T_prrw</span>, tau <span class="op">=</span> <span class="fl">2</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Observe that in this example we are giving the random walker the possibility to teleport to itself. If you want to exclude this possibility, instead of having <span class="math inline">\(\alpha \frac1N \mathbf{1}^T \mathbf{1}\)</span> chose <span class="math inline">\(\frac{1}{N-1} (\mathbf{1}^T \mathbf{1} - \mathbf{I})\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_distance_matrix.html">plot_distance_matrix</a></span><span class="op">(</span><span class="va">ddm_prrw</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="diffusion-distances_files/figure-html/prrw-ddm-plot-1.png" alt="Distance matrix of the karate club network at $\tau=2$ for the PRRW." width="720"><p class="caption">
Distance matrix of the karate club network at <span class="math inline">\(\tau=2\)</span> for the PRRW.
</p>
</div>
</div>
<div id="diffusion-distances-of-large-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#diffusion-distances-of-large-networks" class="anchor"></a>Diffusion distances of large networks</h2>
<p>To and large (<span class="math inline">\(N&gt;1000\)</span>) networks correspond large (usually sparse) matrices and this increases the computational cost of evaluating <span class="math inline">\(e^{-t\mathbf{L}}\)</span>, for some network Laplacian <span class="math inline">\(\mathbf{L}\)</span><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, which is approximately <span class="math inline">\(O(N^3)\)</span> <span class="citation">(Moler and Van Loan 2003)</span>. By default the function <code><a href="../reference/get_distance_matrix.html">get_distance_matrix()</a></code> computes the required type of Laplacian and passes it to the function <code>expm</code> of the homonymous <code>expm</code> <span class="citation">(Goulet et al. 2021)</span>, which is written in  and computes the (Padé-Approximation of the) matrix exponential with the “Scaling &amp; Squaring” method. Alternatively, one can choose to compute the eigendecomposition of the Laplacian, e.g. through <code><a href="../reference/get_spectral_decomp.html">get_spectral_decomp()</a></code> for the normalised Laplacian <span class="math inline">\(\mathbf{\tilde{L}} = \mathbf{I} - \mathbf{D}^{-1}\mathbf{A}\)</span>, and then evaluating the distances using <code><a href="../reference/get_ddm_from_eigendec.html">get_ddm_from_eigendec()</a></code>.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Arenas2008" class="csl-entry">
Arenas, A., A. Fernández, and S. Gómez. 2008. <span>“Analysis of the Structure of Complex Networks at Different Resolution Levels”</span> 10 (5): 053039. <a href="https://doi.org/10.1088/1367-2630/10/5/053039">https://doi.org/10.1088/1367-2630/10/5/053039</a>.
</div>
<div id="ref-Bertagnolli2021" class="csl-entry">
Bertagnolli, Giulia, and Manlio De Domenico. 2021. <span>“Diffusion Geometry of Multiplex and Interdependent Systems.”</span> <em>Physical Review E: Statistical Physics, Plasmas, Fluids, and Related Interdisciplinary Topics</em> 103 (4): 042301. <a href="https://doi.org/10.1103/PhysRevE.103.042301">https://doi.org/10.1103/PhysRevE.103.042301</a>.
</div>
<div id="ref-Biamonte2019" class="csl-entry">
Biamonte, Jacob, Mauro Faccin, and Manlio De Domenico. 2019. <span>“Complex Networks from Classical to Quantum.”</span> <em>Communications Physics</em> 2 (1): 1–10. <a href="https://doi.org/10.1038/s42005-019-0152-6">https://doi.org/10.1038/s42005-019-0152-6</a>.
</div>
<div id="ref-Brin1998" class="csl-entry">
Brin, Sergey, and Lawrence Page. 1998. <span>“The Anatomy of a Large-Scale Hypertextual Web Search Engine.”</span> <em>Comput. Netw. ISDN Syst.</em> 30 (1-7): 107–17.
</div>
<div id="ref-Burda2009" class="csl-entry">
Burda, Zdzislaw, Jarek Duda, Jean-Marc Luck, and Bartek Waclaw. 2009. <span>“Localization of the Maximal Entropy Random Walk.”</span> <em>Physical Review Letters</em> 102 (16): 160602. <a href="https://doi.org/10.1103/PhysRevLett.102.160602">https://doi.org/10.1103/PhysRevLett.102.160602</a>.
</div>
<div id="ref-Chung1997" class="csl-entry">
Chung, Fan R. K. 1997. <em>Spectral Graph Theory</em>. 2. print. CBMS Regional Conference Series in Mathematics; 92. Providence, R.I: Conference board of the mathematical sciences.
</div>
<div id="ref-Chung2010" class="csl-entry">
Chung, Fan, and Wenbo Zhao. 2010. <span>“Pagerank and Random Walks on Graphs.”</span> In <em>Fete of Combinatorics and Computer Science</em>, 43–62. Springer.
</div>
<div id="ref-Coifman2006" class="csl-entry">
Coifman, Ronald R., and Stéphane Lafon. 2006. <span>“Diffusion Maps.”</span> <em>Applied and Computational Harmonic Analysis</em> 21 (1): 5–30. <a href="https://doi.org/10.1016/j.acha.2006.04.006">https://doi.org/10.1016/j.acha.2006.04.006</a>.
</div>
<div id="ref-igraphdata" class="csl-entry">
Csardi, Gabor. 2015. <em>Igraphdata: A Collection of Network Data Sets for the ’Igraph’ Package</em>. <a href="https://CRAN.R-project.org/package=igraphdata">https://CRAN.R-project.org/package=igraphdata</a>.
</div>
<div id="ref-Rigraph" class="csl-entry">
Csardi, Gabor, and Tamas Nepusz. 2006. <span>“The Igraph Software Package for Complex Network Research.”</span> <em>InterJournal</em> Complex Systems: 1695. <a href="https://igraph.org">https://igraph.org</a>.
</div>
<div id="ref-DeDomenico2017" class="csl-entry">
De Domenico, Manlio. 2017. <span>“Diffusion Geometry Unravels the Emergence of Functional Clusters in Collective Phenomena.”</span> <em>Physical Review Letters</em> 118 (16): 168301. <a href="https://doi.org/10.1103/physrevlett.118.168301">https://doi.org/10.1103/physrevlett.118.168301</a>.
</div>
<div id="ref-parallelDist" class="csl-entry">
Eckert, Alexander. 2018. <em>parallelDist: Parallel Distance Matrix Computation Using Multiple Threads</em>. <a href="https://CRAN.R-project.org/package=parallelDist">https://CRAN.R-project.org/package=parallelDist</a>.
</div>
<div id="ref-Fortunato2010" class="csl-entry">
Fortunato, Santo. 2010. <span>“Community Detection in Graphs”</span> 486 (3-5): 75–174. <a href="https://doi.org/10.1016/j.physrep.2009.11.002">https://doi.org/10.1016/j.physrep.2009.11.002</a>.
</div>
<div id="ref-expm" class="csl-entry">
Goulet, Vincent, Christophe Dutang, Martin Maechler, David Firth, Marina Shapira, and Michael Stadelmann. 2021. <em>Expm: Matrix Exponential, Log, ’Etc’</em>. <a href="https://CRAN.R-project.org/package=expm">https://CRAN.R-project.org/package=expm</a>.
</div>
<div id="ref-Lambiotte2014" class="csl-entry">
Lambiotte, Renaud, Jean-Charles Delvenne, and Mauricio Barahona. 2014. <span>“Random Walks, Markov Processes and the Multiscale Modular Organization of Complex Networks.”</span> <em>IEEE Transactions on Network Science and Engineering</em> 1 (2): 76–90. <a href="https://doi.org/10.1109/TNSE.2015.2391998">https://doi.org/10.1109/TNSE.2015.2391998</a>.
</div>
<div id="ref-Masuda2017" class="csl-entry">
Masuda, Naoki, Mason A. Porter, and Renaud Lambiotte. 2017. <span>“<span class="nocase">Random walks and diffusion on networks</span>.”</span> <em>Physics Reports</em> 716-717 (December): 1–58. <a href="https://doi.org/10.1016/j.physrep.2017.07.007">https://doi.org/10.1016/j.physrep.2017.07.007</a>.
</div>
<div id="ref-Moler2003" class="csl-entry">
Moler, Cleve, and Charles Van Loan. 2003. <span>“Nineteen Dubious Ways to Compute the Exponential of a Matrix, Twenty-Five Years Later.”</span> <em>SIAM Rev. Soc. Ind. Appl. Math.</em> 45 (1): 3–49.
</div>
<div id="ref-Norris1998" class="csl-entry">
Norris, James R. 1998. <em>Markov Chains</em>. Cambridge university press.
</div>
<div id="ref-Zachary1977" class="csl-entry">
Zachary, Wayne W. 1977. <span>“An Information Flow Model for Conflict and Fission in Small Groups.”</span> <em>Journal of Anthropological Research</em> 33 (4): 452–73. <a href="https://www.jstor.org/stable/3629752">https://www.jstor.org/stable/3629752</a>.
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The <code>karate</code> network is also available as an unweighted network in <code>igraph</code> <span class="citation">(Csardi and Nepusz 2006)</span> <code><a href="https://rdrr.io/pkg/igraph/man/make_graph.html">make_graph("Zachary")</a></code> and as a weighted network in the data package <code>igraphdata</code> <span class="citation">(Csardi 2015)</span>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The karate club network is connected and non-bipartite, hence the random walk on it is ergodic and the process converges to the invariant/stationary distribution <span class="citation">(F. R. K. Chung 1997)</span>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>The complexity of the actual computation of diffusion distances reduces to that of the matrix exponential, since the Euclidean distances are computed efficiently using the <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> function of the package <code>stats</code> or, if available, its parallelised version <code>Dist()</code> of <code>parallelDist</code> <span class="citation">(Eckert 2018)</span><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giulia Bertagnolli, Manlio De Domenico.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
